<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Golang Vulnerability Scanner</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="styles.css" rel="stylesheet">
	</head>
	<body class="container mt-5">
		<!-- Dark Mode Toggle Button -->
		<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
			<span id="themeIcon" class="theme-icon moon"></span>
		</button>
		
		<h2 class="text-center">Golang Vulnerability Scanner</h2>
		<p class="text-center text-muted">Analyze your Golang-based repository for vulnerabilities</p>	
		<div class="card p-3 shadow-sm mb-4">
			<code class="d-block rounded p-3 text-start" style="font-size: 0.9em;">
				Important fields that need to be checked in the JSON output<br><br>
				<strong>IsVulnerable:</strong> It has three values - true, false, and unknown. If it is true, then the repository is vulnerable to the CVE ID. If it is false, then the repository is not vulnerable to the CVE ID. If it is unknown, then the scanning is failed.<br>
				<strong>AffectedImports:</strong> It is a list of symbols that are affected by the CVE ID. It contains information about the symbol's name, version, and its library name.<br>
				<strong>UsedImports:</strong> It is a list of symbols that are used in the repository. If it is empty, then the repository is not vulnerable to the CVE ID.<br>
				<strong>FixSuccess / FixErrors:</strong> It is the output and error after running the UsedImports.FixCommands in the JSON output from GVS host.<br>
				<strong>CursorCommand:</strong> It is a command that can be executed in the terminal to open the scanned repository in Cursor IDE. Type 'read gvs-output.txt and get the context' in the Cursor chat to start working on the fix.<br>
				<strong>Summary:</strong> It is a summary of the JSON output using the Gemini API.<br>
			</code>
		</div>
		<div class="card p-4 shadow-sm expandable-card" onclick="handleCardClick(event)">
			<div class="card-header-section">
				<div class="row mb-3 align-items-end">
					<div class="col-md-4">
						<label for="repo" class="form-label">
							Repository URL
							<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted" 
								  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
								  data-bs-toggle="tooltip" data-bs-placement="top" 
								  title="Git repository URL from GitHub, GitLab, Bitbucket, etc. Must be publicly accessible.">?</span>
						</label>
						<input type="text" id="repo" class="form-control" placeholder="Enter repo URL" value="https://github.com/openshift/sriov-network-device-plugin">
					</div>
					<div class="col-md-2">
						<label for="branchOrCommit" class="form-label">
							Branch or Commit ID
							<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted" 
								  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
								  data-bs-toggle="tooltip" data-bs-placement="top" 
								  title="Branch name (e.g., main, master, develop) or commit hash (e.g., abc123f, 1a2b3c4d5e6f7a8b). For commit hashes, use 7+ character SHA hashes for reliable detection.">?</span>
						</label>
						<input type="text" id="branchOrCommit" class="form-control" placeholder="Branch or commit id" value="release-4.18">
					</div>
				<div class="col-md-2">
					<label for="cve" class="form-label">
						CVE ID (optional)
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted" 
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top" 
							  title="Enter either a CVE ID (e.g., CVE-2024-45338) or GOCVE ID (e.g., GO-2024-3333). If left empty, scans for all known Go vulnerabilities in the repository.">?</span>
					</label>
					<input type="text" id="cve" class="form-control" placeholder="Enter CVE ID or GOCVE ID" value="CVE-2024-45339">
				</div>
				<div class="col-md-1">
					<label for="algo" class="form-label">
						Algo
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted"
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top"
							  title="Call graph algorithm: RTA (default, best for reflection), VTA (precise but slower), CHA (fast but less precise), Static (fastest, direct calls only).">?</span>
					</label>
					<select id="algo" class="form-select">
						<option value="rta" selected>RTA</option>
						<option value="vta">VTA</option>
						<option value="cha">CHA</option>
						<option value="static">Static</option>
					</select>
				</div>
				<div class="col-md-1">
					<label for="graph" class="form-label">
						Graph
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted"
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top"
							  title="Generate call graph visualizations (SVG) showing paths from main to vulnerable symbols. One graph per affected symbol. Requires graphviz/sfdp.">?</span>
					</label>
					<select id="graph" class="form-select">
						<option value="false">No</option>
						<option value="true">Yes</option>
					</select>
				</div>
				<div class="col-md-2 text-end">
					<button id="scanButton" class="btn btn-primary w-100" onclick="runScan()">Run Scan</button>
				</div>
			</div>
			<div class="row mb-3 align-items-end">
				<div class="col-md-4">
					<label for="library" class="form-label">
						Library (optional)
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted"
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top"
							  title="Specify a library path to scan (e.g., golang.org/x/net/html). When provided with Symbol, this takes precedence over CVE-based scanning.">?</span>
					</label>
					<input type="text" id="library" class="form-control" placeholder="e.g., golang.org/x/net/html">
				</div>
				<div class="col-md-5">
					<label for="symbol" class="form-label">
						Symbol (optional)
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted"
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top"
							  title="Specify a symbol name to scan for (e.g., Parse, Render). Multiple symbols can be comma-separated. Used with Library field.">?</span>
					</label>
					<input type="text" id="symbol" class="form-control" placeholder="e.g., Parse, Render">
				</div>
				<div class="col-md-3">
					<label for="fixversion" class="form-label">
						Fixed Version (optional)
						<span class="d-inline-flex align-items-center justify-content-center ms-1 text-muted"
							  style="width: 16px; height: 16px; border-radius: 50%; border: 1px solid #6c757d; font-size: 11px; cursor: help; vertical-align: middle; transform: translateY(-2px);"
							  data-bs-toggle="tooltip" data-bs-placement="top"
							  title="Specify the fixed version for manual scans (e.g., v1.9.4). Used with Library and Symbol fields for version comparison.">?</span>
					</label>
					<input type="text" id="fixversion" class="form-control" placeholder="e.g., v1.9.4">
				</div>
				</div>
			</div>
			
			<!-- Integrated Progress Section -->
			<div class="progress-section">
				<div id="progressContent" class="progress-content collapsed">
					<div class="progress-placeholder">Server progress will appear here during scans. Progress from previous scans is preserved until the next scan starts.</div>
				</div>
			</div>
		</div>
		<div id="output" class="result-card"></div>
		<script src="config.js"></script>
		<script src="script.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			// Initialize Bootstrap tooltips
			document.addEventListener('DOMContentLoaded', function () {
				var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
				var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
					return new bootstrap.Tooltip(tooltipTriggerEl);
				});
			});
		</script>
		<footer class="mt-5 pb-4 text-center text-muted">&copy; 2025 Golang Vulnerability Scanner</footer>
	</body>
</html>
